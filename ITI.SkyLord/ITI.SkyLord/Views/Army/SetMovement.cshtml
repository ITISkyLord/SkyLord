@addTagHelper "*, Microsoft.AspNet.Mvc.TagHelpers"
@model ITI.SkyLord.ViewModel.Armies.SetMovementArmyViewModel
@using ITI.SkyLord

@{
    ViewData["Title"] = "Transport de troupes";
    Layout = "_Layout";
}

<div class="armyContainer">
    <div class="army">
        <div class="army-body">

            <div class="army-head">
                Planification d'un mouvement de troupes
            </div>

            @if (Model.CurrentDefenseArmy != null)
            {
                <form asp-controller="Army" asp-action="MoveArmy" asp-route-islandId="@Model.Layout.IslandId" method="post" role="form">

                    <div asp-validation-summary="ValidationSummary.All" class="text-danger"></div>
                    <p>Vous pouvez transférer vos unités entre vos îles.</p>
                    @* Tableau pour voir nos unité et voir qui l'on envoi *@
                    <div class="numberArmy">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <td>Unité</td>
                                    <td>Disponible</td>
                                    <td>À envoyer</td>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (Regiment r in Model.CurrentDefenseArmy.Regiments)
                                {
                                    <tr>
                                        <td>@r.Unit.Name</td>
                                        <td>@r.Number</td>
                                        <td><input type="number" min="0" max="@r.Number" step="1" asp-for="UnitsToSend[r.Unit.UnitName.ToString()]" value="0" /></td>
                                    </tr>
                                }
                            </tbody>

                        </table>
                    </div>

                    <div asp-validation-summary="ValidationSummary.All" class="text-danger"></div>

                    @* Choix de la cible *@
                    <select asp-for="@Model.TargetIslandId" id="EnnemyToAttack">
                        @foreach (Island i in Model.Layout.AllIslands.Where(i => i.IslandId != Model.Layout.IslandId))
                        {
                            <option value="@i.IslandId" pos-x="@i.Coordinates.X" pos-y="@i.Coordinates.Y" selected="selected">
                               @i.Name [@i.Coordinates.X, @i.Coordinates.Y]
                            </option>
                        }
                    </select>

                    <input type="submit" class="btn-link" value="Envoyer les unités" />
                </form>
            }
            else
            {
                <p>Vous n'avez pas encore d'armée, allez au portail d'invocation pour vous préparer à la guerre.</p>
            }

        </div>
    </div>
</div>
